<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2024-01-01T00:00:00.000Z" agent="Lovable" version="22.1.0" type="device">
  <diagram name="CCoE Chat Ops Architecture" id="architecture">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- User Browser Container -->
        <mxCell id="browser-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="40" y="40" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="browser-label" value="User Browser" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="40" y="45" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="react-ui" value="React Chat UI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4a90d9;strokeColor=#2d5a87;fontColor=#ffffff;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="75" width="120" height="50" as="geometry" />
        </mxCell>
        
        <!-- n8n Instance Container -->
        <mxCell id="n8n-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="960" y="40" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="n8n-label" value="n8n Instance" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="960" y="45" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="n8n-workflows" value="n8n Workflows&#xa;n8n-dev.dei.gr" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ff6d5a;strokeColor=#cc4a3a;fontColor=#ffffff;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="980" y="75" width="120" height="50" as="geometry" />
        </mxCell>
        
        <!-- AKS Container -->
        <mxCell id="aks-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="280" y="180" width="600" height="400" as="geometry" />
        </mxCell>
        <mxCell id="aks-label" value="Azure Kubernetes Service" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="280" y="185" width="600" height="25" as="geometry" />
        </mxCell>
        
        <!-- Istio Service Mesh -->
        <mxCell id="istio-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="300" y="220" width="560" height="100" as="geometry" />
        </mxCell>
        <mxCell id="istio-label" value="Istio Service Mesh" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="300" y="225" width="560" height="20" as="geometry" />
        </mxCell>
        <mxCell id="istio-gateway" value="Istio Gateway&#xa;dei-gateway" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#9b59b6;strokeColor=#7d3c98;fontColor=#ffffff;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="340" y="255" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="virtualservice" value="VirtualService" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#9b59b6;strokeColor=#7d3c98;fontColor=#ffffff;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="255" width="120" height="50" as="geometry" />
        </mxCell>
        
        <!-- ccoe-chat-ops namespace -->
        <mxCell id="namespace-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="300" y="340" width="560" height="220" as="geometry" />
        </mxCell>
        <mxCell id="namespace-label" value="ccoe-chat-ops namespace" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="300" y="345" width="560" height="20" as="geometry" />
        </mxCell>
        <mxCell id="k8s-service" value="K8s Service&#xa;:80" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1e8449;strokeColor=#145a32;fontColor=#ffffff;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="375" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="pod1" value="Pod 1&#xa;Express Server&#xa;:8080" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#2ecc71;strokeColor=#1e8449;fontColor=#ffffff;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="400" y="470" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="pod2" value="Pod 2&#xa;Express Server&#xa;:8080" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#2ecc71;strokeColor=#1e8449;fontColor=#ffffff;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="640" y="470" width="120" height="70" as="geometry" />
        </mxCell>
        
        <!-- Arrows -->
        <!-- Browser to Gateway -->
        <mxCell id="arrow1" value="1. POST /api/chat&#xa;(message + sessionId)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#2d5a87;fontColor=#2d5a87;labelBackgroundColor=#ffffff;" edge="1" parent="1" source="react-ui" target="istio-gateway">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="120" y="170" />
              <mxPoint x="400" y="170" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Gateway to VirtualService -->
        <mxCell id="arrow2" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#7d3c98;" edge="1" parent="1" source="istio-gateway" target="virtualservice">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- VirtualService to Service -->
        <mxCell id="arrow3" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#1e8449;" edge="1" parent="1" source="virtualservice" target="k8s-service">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Service to Pods -->
        <mxCell id="arrow4" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#1e8449;" edge="1" parent="1" source="k8s-service" target="pod1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow5" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#1e8449;" edge="1" parent="1" source="k8s-service" target="pod2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Pod to n8n -->
        <mxCell id="arrow6" value="2. Proxy to n8n&#xa;(webhook URL hidden)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#cc4a3a;fontColor=#cc4a3a;labelBackgroundColor=#ffffff;" edge="1" parent="1" source="pod1" target="n8n-workflows">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="460" y="600" />
              <mxPoint x="920" y="600" />
              <mxPoint x="920" y="100" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- n8n response back -->
        <mxCell id="arrow7" value="3. Response: {runID, status: 'in_progress'}" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#2ecc71;fontColor=#1e8449;labelBackgroundColor=#ffffff;dashed=1;" edge="1" parent="1" source="n8n-workflows" target="react-ui">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1040" y="30" />
              <mxPoint x="120" y="30" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- SSE subscription -->
        <mxCell id="arrow8" value="5. GET /api/webhook/stream/:runID&#xa;(SSE connection)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#4a90d9;fontColor=#2d5a87;labelBackgroundColor=#ffffff;dashed=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="180" y="100" as="sourcePoint" />
            <mxPoint x="700" y="280" as="targetPoint" />
            <Array as="points">
              <mxPoint x="220" y="100" />
              <mxPoint x="220" y="160" />
              <mxPoint x="700" y="160" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- n8n webhook update -->
        <mxCell id="arrow9" value="6. POST /api/webhook/update&#xa;{jobId, status: 'completed', answer}" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#ff6d5a;fontColor=#cc4a3a;labelBackgroundColor=#ffffff;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="980" y="125" as="sourcePoint" />
            <mxPoint x="700" y="305" as="targetPoint" />
            <Array as="points">
              <mxPoint x="900" y="125" />
              <mxPoint x="900" y="305" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- SSE push to client -->
        <mxCell id="arrow10" value="7. SSE: {status: 'completed', answer}" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#2ecc71;fontColor=#1e8449;labelBackgroundColor=#ffffff;dashed=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="340" y="280" as="sourcePoint" />
            <mxPoint x="160" y="125" as="targetPoint" />
            <Array as="points">
              <mxPoint x="250" y="280" />
              <mxPoint x="250" y="125" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#333333;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="620" width="200" height="140" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="50" y="625" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-ui" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4a90d9;strokeColor=#2d5a87;" vertex="1" parent="1">
          <mxGeometry x="50" y="650" width="20" height="15" as="geometry" />
        </mxCell>
        <mxCell id="legend-ui-text" value="React UI" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="647" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-n8n" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ff6d5a;strokeColor=#cc4a3a;" vertex="1" parent="1">
          <mxGeometry x="50" y="670" width="20" height="15" as="geometry" />
        </mxCell>
        <mxCell id="legend-n8n-text" value="n8n" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="667" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-istio" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#9b59b6;strokeColor=#7d3c98;" vertex="1" parent="1">
          <mxGeometry x="50" y="690" width="20" height="15" as="geometry" />
        </mxCell>
        <mxCell id="legend-istio-text" value="Istio" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="687" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-pods" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#2ecc71;strokeColor=#1e8449;" vertex="1" parent="1">
          <mxGeometry x="50" y="710" width="20" height="15" as="geometry" />
        </mxCell>
        <mxCell id="legend-pods-text" value="Express Pods" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="707" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-k8s" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1e8449;strokeColor=#145a32;" vertex="1" parent="1">
          <mxGeometry x="50" y="730" width="20" height="15" as="geometry" />
        </mxCell>
        <mxCell id="legend-k8s-text" value="K8s Service" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="727" width="80" height="20" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
